事件循环
所有的任务可以分为同步任务和异步任务，同步任务，顾名思义，就是立即执行的任务，同步任务一般会直接进入到主线程中执行。而异步任务，就是异步执行的任务，比如 ajax 网络请求，setTimeout 定时函数等都属于异步任务，异步任务会通过任务队列的机制(先进先出的机制)来进行协调。

同步和异步任务分别进入不同的执行环境，同步的进入主线程，即主执行栈，异步的进入任务队列。主线程内的任务执行完毕为空，会去任务队列读取对应的任务，推入主线程执行。上述过程的不断重复就是我们说的 Event Loop (事件循环)。

在事件循环中，每进行一次循环操作称为 tick，其关键的步骤可以总结如下：

一开始整个脚本作为一个宏任务执行
执行过程中同步代码直接执行，宏任务进入宏任务队列，微任务进入微任务队列
当前宏任务执行完出队，读取微任务列表，有则依次执行，直到全部执行完
读取宏任务列表，有则依次执行，直到全部执行完
执行浏览器 UI 线程的渲染工作
检查是否有 Web Worker 任务，有则执行
执行完本轮的宏任务，回到第 2 步，继续依此循环，直到宏任务和微任务队列都为空
宏任务与微任务
JS 引擎把所有任务分成两类，一类叫宏任务(macrotask)，一类叫微任务(microtask)。

宏任务主要包含：

js（整体代码）
I/O、UI 渲染
MessageChannel、postMessage
setImmediate（Node.js 环境）
setTimeout、setInterval
requestAnimationFrame 属于 GUI 引擎，发生在渲染过程的重绘重排部分，在 UI 渲染之前执行
微任务主要包含：

process.nextTick（Node.js 环境）
MutaionObserver（浏览器环境）
Promise
先执行完微任务再执行宏任务。